<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
  <title>–ù–∞—Å—Ç—è ‚ù§Ô∏è –ú–ï–ú–ù–´–ô –¢–ï–õ–ï–ì–†–ê–ú</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
    }

    body {
      background: linear-gradient(145deg, #fce4ec 0%, #ffe0f0 50%, #ffd9e8 100%);
      color: #2d2d2d;
      overflow: hidden;
      position: relative;
    }

    body::before {
      content: '';
      position: fixed;
      top: 0; left: 0; width: 100%; height: 100%;
      background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" opacity="0.1"><path fill="%23ff99cc" d="M50 30c-5-10-20-10-25 0-5 10 5 25 25 35 20-10 30-25 25-35-5-10-20-10-25 0z"/></svg>');
      background-size: 80px 80px;
      pointer-events: none;
      z-index: 0;
    }

    .app {
      height: 100vh;
      display: flex;
      flex-direction: column;
      position: relative;
      z-index: 2;
      background: rgba(255, 255, 255, 0.2);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      box-shadow: 0 0 30px rgba(255, 150, 200, 0.3);
    }

    .topbar {
      background: rgba(255, 220, 240, 0.7);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      padding: 16px 14px;
      font-weight: 700;
      font-size: 22px;
      color: #b3406c;
      text-shadow: 0 2px 4px rgba(255,255,255,0.5);
      display: flex;
      align-items: center;
      gap: 10px;
      border-bottom: 1px solid #ffb3d1;
    }

    .topbar span {
      background: #ffb3d1;
      color: #9e2a5b;
      padding: 4px 12px;
      border-radius: 40px;
      font-size: 14px;
      font-weight: 500;
      margin-left: auto;
    }

    .chat-list {
      flex: 1;
      overflow-y: auto;
      padding: 4px 8px;
    }

    .chat-item {
      display: flex;
      align-items: center;
      padding: 12px;
      gap: 12px;
      background: rgba(255, 255, 255, 0.5);
      backdrop-filter: blur(4px);
      -webkit-backdrop-filter: blur(4px);
      border-radius: 28px;
      margin-bottom: 8px;
      border: 1px solid rgba(255, 200, 220, 0.7);
      transition: all 0.2s;
      cursor: pointer;
      box-shadow: 0 4px 6px rgba(255, 160, 200, 0.1);
    }

    .chat-item:hover {
      background: rgba(255, 230, 240, 0.9);
      transform: scale(1.01);
      border-color: #ffa5c3;
    }

    .avatar {
      width: 56px;
      height: 56px;
      border-radius: 50%;
      background-size: cover;
      background-position: center;
      border: 2px solid white;
      box-shadow: 0 4px 8px rgba(255, 100, 150, 0.3);
    }

    .chat-info {
      flex: 1;
    }

    .chat-name {
      font-weight: 700;
      color: #87234f;
      font-size: 17px;
    }

    .chat-last {
      font-size: 14px;
      color: #a04d6e;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 180px;
    }

    .chat-time {
      font-size: 12px;
      color: #b06d89;
      background: rgba(255,255,240,0.5);
      padding: 4px 8px;
      border-radius: 30px;
    }

    .chat-window {
      position: absolute;
      top: 0;
      left: 100%;
      width: 100%;
      height: 100%;
      background: rgba(255, 245, 250, 0.85);
      backdrop-filter: blur(25px);
      -webkit-backdrop-filter: blur(25px);
      display: flex;
      flex-direction: column;
      transition: left 0.35s cubic-bezier(0.2, 0.9, 0.3, 1);
      z-index: 10;
      box-shadow: -10px 0 30px rgba(210, 120, 160, 0.3);
    }

    .chat-window.active {
      left: 0;
    }

    .chat-header {
      background: rgba(255, 210, 230, 0.7);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      padding: 10px 16px;
      display: flex;
      gap: 12px;
      align-items: center;
      border-bottom: 1px solid #ffbfd7;
    }

    .back {
      cursor: pointer;
      font-size: 26px;
      color: #ad3f6b;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      background: white;
      box-shadow: 0 2px 8px rgba(255,120,160,0.3);
      transition: 0.2s;
    }

    .back:hover {
      background: #ffe5f0;
    }

    .chat-header .avatar {
      width: 48px;
      height: 48px;
    }

    #chatTitle {
      font-weight: 700;
      font-size: 18px;
      color: #831d48;
    }

    #status {
      font-size: 13px;
      color: #c54773;
      display: flex;
      align-items: center;
      gap: 4px;
    }

    #status::before {
      content: '‚óè';
      color: #4caf50;
      font-size: 10px;
      animation: pulse 1.2s infinite;
    }

    @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.5; } }

    .messages {
      flex: 1;
      padding: 16px 12px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 12px;
      background: rgba(255, 235, 245, 0.2);
    }

    .message {
      max-width: 80%;
      padding: 10px 14px;
      border-radius: 22px;
      font-size: 15px;
      line-height: 1.4;
      animation: messagePop 0.2s ease-out;
      box-shadow: 0 2px 10px rgba(170, 100, 130, 0.15);
      word-wrap: break-word;
    }

    @keyframes messagePop {
      0% { opacity: 0; transform: translateY(8px) scale(0.96); }
      100% { opacity: 1; transform: translateY(0) scale(1); }
    }

    .sent {
      align-self: flex-end;
      background: #f9c9df;
      color: #451f2f;
      border-bottom-right-radius: 6px;
    }

    .received {
      align-self: flex-start;
      background: white;
      color: #381f2b;
      border-bottom-left-radius: 6px;
    }

    .time {
      font-size: 10px;
      color: #a5697e;
      margin-left: 8px;
      opacity: 0.8;
    }

    .input-area {
      display: flex;
      padding: 10px 12px;
      background: rgba(255, 220, 235, 0.6);
      backdrop-filter: blur(15px);
      -webkit-backdrop-filter: blur(15px);
      gap: 8px;
      border-top: 1px solid #ffbfd7;
    }

    #userInput {
      flex: 1;
      padding: 12px 18px;
      border: none;
      border-radius: 40px;
      background: rgba(255, 255, 255, 0.9);
      color: #2f1d26;
      font-size: 15px;
      box-shadow: inset 0 2px 6px rgba(210, 120, 150, 0.2);
    }

    #userInput:focus {
      outline: 2px solid #ff99c2;
    }

    button {
      padding: 12px 20px;
      border: none;
      border-radius: 40px;
      background: #ff99c2;
      color: white;
      font-weight: 600;
      font-size: 16px;
      box-shadow: 0 4px 10px #fbb0cf;
      transition: 0.15s;
      cursor: pointer;
    }

    button:hover {
      background: #ff80b5;
      transform: scale(1.02);
    }

    .options-container {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
      margin: 10px 0 5px;
    }

    .option-btn {
      background: white;
      border: 2px solid #ff99c2;
      color: #b34e7a;
      padding: 12px 18px;
      border-radius: 40px;
      font-size: 15px;
      font-weight: 600;
      box-shadow: 0 4px 10px rgba(255, 150, 200, 0.4);
      cursor: pointer;
      transition: 0.15s;
      flex: 1 1 auto;
      min-width: 120px;
    }

    .option-btn:hover {
      background: #ffe2f0;
      transform: scale(1.02);
    }

    .heart {
      position: fixed;
      font-size: 28px;
      animation: floatUp 5s linear forwards;
      z-index: 9999;
      pointer-events: none;
      filter: drop-shadow(0 0 6px hotpink);
    }

    @keyframes floatUp {
      0% { transform: translateY(0) rotate(0deg); opacity: 1; }
      100% { transform: translateY(-100vh) rotate(10deg); opacity: 0; }
    }

    .desktop-hint {
      position: fixed;
      bottom: 10px;
      left: 0;
      right: 0;
      z-index: 999;
      text-align: center;
      color: #b04e77;
      text-shadow: 0 1px 4px white;
      font-size: 16px;
      background: rgba(255, 240, 245, 0.6);
      padding: 6px;
      border-radius: 40px;
      width: fit-content;
      margin: 0 auto;
      backdrop-filter: blur(2px);
    }
  </style>
</head>
<body>

<audio id="bgMusic" loop volume="0.2">
  <source src="https://cdn.pixabay.com/audio/2023/09/17/audio_0b4a5e6f5d.mp3" type="audio/mpeg">
</audio>

<div class="app">
  <div class="topbar">
    üå∏ –ù–∞—Å—Ç—è ‚ù§Ô∏è –ú–ï–ú –ß–ê–¢
    <span>14 —Ñ–µ–≤</span>
  </div>
  <div class="chat-list" id="chatList"></div>
</div>

<div class="chat-window" id="chatWindow">
  <div class="chat-header">
    <div class="back" onclick="closeChat()">‚Üê</div>
    <div class="avatar" id="chatAvatar"></div>
    <div style="flex:1">
      <div id="chatTitle"></div>
      <div id="status">–≤ —Å–µ—Ç–∏</div>
    </div>
  </div>

  <div class="messages" id="messages"></div>

  <div id="optionsArea" class="input-area" style="justify-content: center; display: none;"></div>
  <div class="input-area" id="manualInputArea" style="display: flex;">
    <input id="userInput" placeholder="–¢–≤–æ—ë —Å–æ–æ–±—â–µ–Ω–∏–µ..." autocomplete="off">
    <button onclick="sendManualMessage()">üí¨</button>
  </div>
</div>

<script>
  (function() {
    const HER_NAME = '–ù–∞—Å—Ç—è';

    // ---------- –ú–ï–ú–ù–´–ï –ê–í–ê–¢–ê–†–ö–ò (SVG —Å —Ç–µ–∫—Å—Ç–æ–º) ----------
    const avatars = [
      "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='45' fill='%23ff69b4'/%3E%3Ctext x='50' y='60' font-size='28' text-anchor='middle' fill='white' font-weight='bold'%3E–ú–ï–õ–°–¢–†–û–ô%3C/text%3E%3C/svg%3E",
      "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='45' fill='%234169E1'/%3E%3Ctext x='50' y='60' font-size='28' text-anchor='middle' fill='white' font-weight='bold'%3E–î–†–£–ù%3C/text%3E%3C/svg%3E",
      "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='45' fill='%23FFD700'/%3E%3Ctext x='50' y='60' font-size='28' text-anchor='middle' fill='black' font-weight='bold'%3E–ê–†–¢–£–†%3C/text%3E%3C/svg%3E",
      "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='45' fill='%23FFA07A'/%3E%3Ctext x='50' y='60' font-size='28' text-anchor='middle' fill='white' font-weight='bold'%3E–ß–ê–ù%3C/text%3E%3C/svg%3E",
      "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='45' fill='%239ACD32'/%3E%3Ctext x='50' y='60' font-size='28' text-anchor='middle' fill='white' font-weight='bold'%3E–®–£–¢%3C/text%3E%3C/svg%3E",
      "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='45' fill='%23FFB6C1'/%3E%3Ctext x='50' y='60' font-size='28' text-anchor='middle' fill='white' font-weight='bold'%3E–†–û–ú–ê–ù%3C/text%3E%3C/svg%3E",
      "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='45' fill='%238A2BE2'/%3E%3Ctext x='50' y='60' font-size='28' text-anchor='middle' fill='white' font-weight='bold'%3E–§–ò–õ–û–°–û–§%3C/text%3E%3C/svg%3E",
      "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='45' fill='%23DC143C'/%3E%3Ctext x='50' y='60' font-size='28' text-anchor='middle' fill='white' font-weight='bold'%3E–¢–ê–ô–ù–´–ô%3C/text%3E%3C/svg%3E"
    ];

    // ==================== –ú–ï–ú–ù–´–ï –î–ò–ê–õ–û–ì–ò ====================
    const chats = [
      { // 0. –ú–µ–ª—Å—Ç—Ä–æ–π
        name: '–ú–µ–ª—Å—Ç—Ä–æ–π üéôÔ∏è',
        dialog: [
          { person: `–°–ª—ã—à–∞–ª, —Ç—ã –ù–∞—Å—Ç—è —á–∞–Ω? –ù—É —Ç–∞ —Å–∞–º–∞—è, —Å —á–∞–Ω–∞?`, options: [
              { text: '–î–∞, —è –ù–∞—Å—Ç—è —á–∞–Ω!', nextPerson: '–û–≥–æ, —Ä–µ—Å–ø–µ–∫—Ç! –ê —è –ú–µ–ª—Å—Ç—Ä–æ–π, –ª—é–±–ª—é —Å—Ç—Ä–∏–º–∏—Ç—å –∏ –¥—Ä–∏—Å—Ç–µ—Ç—å. –¢—ã —á–∞—Å—Ç–æ –Ω–∞ —á–∞–Ω–µ —Å–∏–¥–∏—à—å?' },
              { text: '–ù–µ, —è –ø—Ä–æ—Å—Ç–æ –ù–∞—Å—Ç—è', nextPerson: '–ñ–∞–ª—å, –∞ —Ç–æ —è –¥—É–º–∞–ª —Ç—ã —Ç–∞ —Å–∞–º–∞—è –ª–µ–≥–µ–Ω–¥–∞. –ù–æ –≤—Å—ë —Ä–∞–≤–Ω–æ –ø—Ä–∏–≤–µ—Ç! –ì–æ –¥—Ä—É–Ω–∏—Ç—å?' }
          ]},
          { person: `–£ –º–µ–Ω—è —Ç—É—Ç –¥—Ä—É–Ω—ã –ø–æ–¥—ä–µ—Ö–∞–ª–∏, –≥–æ–≤–æ—Ä—è—Ç: "–ú–µ–ª—Å—Ç—Ä–æ–π, –∞ –≥–¥–µ –ù–∞—Å—Ç—è?" –ù—É —è –∏ —Ä–µ—à–∏–ª –Ω–∞–ø–∏—Å–∞—Ç—å.`, options: [
              { text: '–ö–∞–∫–∏–µ –¥—Ä—É–Ω—ã?', nextPerson: '–ù—É –¥—Ä—É–Ω—ã ‚Äî —ç—Ç–æ –º–æ–π –∫–ª–∞–Ω! –î—Ä—É–Ω–∏–º –≤—Å–µ—Ö, –∫—Ç–æ –º–∏–º–æ –ø—Ä–æ—Ö–æ–¥–∏—Ç. –•–æ—á–µ—à—å –≤ –¥—Ä—É–Ω—ã?' },
              { text: '–ü—Ä–∏–≤–µ—Ç, –ú–µ–ª—Å—Ç—Ä–æ–π! –¢—ã –∫—Ä—É—Ç–æ —Å—Ç—Ä–∏–º–∏—à—å', nextPerson: '–û, —Å–ø–∞—Å–∏–±–æ! –ü–æ–¥–ø–∏—à–∏—Å—å –Ω–∞ —Å—Ç—Ä–∏–º, —Ç–∞–º –ù–∞—Å—Ç—é —á–∞–Ω —á–∞—Å—Ç–æ —É–ø–æ–º–∏–Ω–∞—é.' }
          ]},
          { person: `–ê —É —Ç–µ–±—è –µ—Å—Ç—å –¥—Ä—É–Ω—ã? –¢—ã –≤–æ–æ–±—â–µ –≤ —Ç–µ–º–µ?`, options: [
              { text: '–£ –º–µ–Ω—è —Å–≤–æ–π –¥—Ä—É–Ω (–ê—Ä—Ç—É—Ä)', nextPerson: '–ê—Ä—Ç—É—Ä? –¢–æ—Ç —Å–∞–º—ã–π —à–æ–ø–æ–≥–æ–ª–∏–∫? –ü—Ä–∏–≤–µ—Ç –ê—Ä—Ç—É—Ä—É!' },
              { text: '–ù–µ—Ç, –Ω–æ —Ö–æ—á—É –≤—Å—Ç—É–ø–∏—Ç—å', nextPerson: '–õ–∞–¥—ã, —Å–µ–π—á–∞—Å —Å –ê—Ä—Ç—É—Ä–æ–º –ø–µ—Ä–µ—Ç—Ä—É ‚Äî –æ–Ω —É –Ω–∞—Å –≥–ª–∞–≤–Ω—ã–π –ø–æ –¥—Ä—É–Ω–∞–º.' }
          ]},
          { person: `–ö—Å—Ç–∞—Ç–∏, –∞ —Ç—ã –∑–Ω–∞–µ—à—å, —á—Ç–æ –ù–∞—Å—Ç—è —á–∞–Ω ‚Äî —ç—Ç–æ –º–µ–º? –û–Ω–∞ –∫–∞–∫-—Ç–æ —Å —á–∞–Ω–∞ —É–ø–∞–ª–∞, —Ç–µ–ø–µ—Ä—å –µ—ë –≤—Å–µ —Ç–∞–∫ –∑–æ–≤—É—Ç.`, options: [
              { text: '–õ–æ–ª, –Ω–µ –∑–Ω–∞–ª–∞', nextPerson: '–ù—É —Ç–µ–ø–µ—Ä—å –∑–Ω–∞–µ—à—å! –î—Ä—É–Ω—ã —Ä–∂—É—Ç —Å —ç—Ç–æ–≥–æ.' },
              { text: '–Ø —Ç–æ—Ç —Å–∞–º—ã–π —á–∞–Ω!', nextPerson: '–û—Ñ–∏–≥–µ—Ç—å! –õ–µ–≥–µ–Ω–¥–∞! –î–∞–≤–∞–π —Å–æ–≤–º–µ—Å—Ç–Ω—ã–π —Å—Ç—Ä–∏–º?' }
          ]},
          { person: `–° 14 —Ñ–µ–≤—Ä–∞–ª—è, –ù–∞—Å—Ç—è! –ü—É—Å—Ç—å –¥—Ä—É–Ω—ã –≤—Å–µ–≥–¥–∞ –±—É–¥—É—Ç —Å —Ç–æ–±–æ–π.`, options: [
              { text: '–ò —Ç–µ–±—è, –ú–µ–ª—Å—Ç—Ä–æ–π!', nextPerson: '–ó–∞—Ö–æ–¥–∏ –Ω–∞ —Å—Ç—Ä–∏–º, —Ç–∞–º –ø–æ–¥–∞—Ä–∫–∏!' },
              { text: '–°–ø–∞—Å–∏–±–æ, –ø—Ä–∏–≤–µ—Ç –ê—Ä—Ç—É—Ä—É', nextPerson: '–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ–¥–∞–º! –ê—Ä—Ç—É—Ä, –ø—Ä–∏–≤–µ—Ç!)' }
          ]},
          { person: `–ù—É —è –ø–æ–≥–Ω–∞–ª –¥—Ä—É–Ω–∏—Ç—å. –ü–æ–∫–∞, –ù–∞—Å—Ç—è —á–∞–Ω!`, options: [] }
        ]
      },
      { // 1. –î—Ä—É–Ω
        name: '–î—Ä—É–Ω üêâ',
        dialog: [
          { person: `–ü—Ä–∏–≤–µ—Ç, —ç—Ç–æ –î—Ä—É–Ω! –°–ª—ã—à–∞–ª, —Ç—ã –¥—Ä—É–∂–∏—à—å —Å –ú–µ–ª—Å—Ç—Ä–æ–µ–º?`, options: [
              { text: '–ü—Ä–∏–≤–µ—Ç! –ù—É —Ç–∞–∫, —à–∞–ø–æ—á–Ω–æ', nextPerson: '–ê —è –µ–≥–æ –≥–ª–∞–≤–Ω—ã–π –¥—Ä—É–Ω. –•–æ—á–µ—à—å —Å—Ç–∞—Ç—å –Ω–∞—à–∏–º –¥—Ä—É–Ω–æ–º?' }
          ]},
          { person: `–£ –Ω–∞—Å —Ç—É—Ç –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤ –¥—Ä—É–Ω–æ–≤, –≤—Å–µ —Å–≤–æ–∏: –ê—Ä—Ç—É—Ä, –ú–µ–ª—Å—Ç—Ä–æ–π, –ù–∞—Å—Ç—è —á–∞–Ω... –ü—Ä–∏–¥—ë—à—å?`, options: [
              { text: '–ê —á—Ç–æ –¥–µ–ª–∞—Ç—å –Ω–∞–¥–æ?', nextPerson: '–î—Ä—É–Ω–∏—Ç—å! –°–º–µ—è—Ç—å—Å—è, —à—É—Ç–∏—Ç—å, –ø–∏—Ç—å —á–∞–π —Å —á–∞–Ω–∞.' },
              { text: '–Ø –ù–∞—Å—Ç—è —á–∞–Ω, –∫–æ–Ω–µ—á–Ω–æ –ø—Ä–∏–¥—É', nextPerson: '–í–ê–£! –¢–∞ —Å–∞–º–∞—è! –Ø —Ç–≤–æ–π —Ñ–∞–Ω–∞—Ç! –î–∞–π –∞–≤—Ç–æ–≥—Ä–∞—Ñ –¥—Ä—É–Ω–æ–º.' }
          ]},
          { person: `–ê —Ç—ã –∑–Ω–∞–µ—à—å, –ø–æ—á–µ–º—É –¥—Ä—É–Ω—ã —Å–º–µ—é—Ç—Å—è? –ü–æ—Ç–æ–º—É —á—Ç–æ —É –Ω–∏—Ö –µ—Å—Ç—å —á–∞–Ω —Å –º–µ–º–∞–º–∏.`, options: [
              { text: '–ü–æ–¥–µ–ª–∏—à—å—Å—è –º–µ–º–∞–º–∏?', nextPerson: '–õ–æ–≤–∏: –º–µ–ª—Å—Ç—Ä–æ–π —É–ø–∞–ª —Å —á–∞–Ω–∞, –¥—Ä—É–Ω –µ–≥–æ –ª–æ–≤–∏—Ç. –†–∂–∞–∫–∞.' },
              { text: '–û–±–æ–∂–∞—é –º–µ–º—ã', nextPerson: '–¢–æ–≥–¥–∞ —Ç—ã —Å–≤–æ—è. –ü—Ä–∏–≤–µ—Ç –æ—Ç –ê—Ä—Ç—É—Ä–∞, –∫—Å—Ç–∞—Ç–∏!' }
          ]},
          { person: `–° 14 —Ñ–µ–≤—Ä–∞–ª—è, –ù–∞—Å—Ç—è! –ñ–µ–ª–∞—é, —á—Ç–æ–±—ã –¥—Ä—É–Ω—ã –≤—Å–µ–≥–¥–∞ –±—ã–ª–∏ —Ä—è–¥–æ–º.`, options: [
              { text: '–°–ø–∞—Å–∏–±–æ, –¥—Ä—É–Ω!', nextPerson: '–í—Å–µ–≥–¥–∞ –ø–æ–∂–∞–ª—É–π—Å—Ç–∞. –ü–µ—Ä–µ–¥–∞–≤–∞–π –ø—Ä–∏–≤–µ—Ç –ú–µ–ª—Å—Ç—Ä–æ—é.' }
          ]},
          { person: `–ù—É —è –ø–æ—à—ë–ª –¥—Ä—É–Ω–∏—Ç—å —Å –ê—Ä—Ç—É—Ä–æ–º. –ü–æ–∫–∞!`, options: [] }
        ]
      },
      { // 2. –ê—Ä—Ç—É—Ä
        name: '–ê—Ä—Ç—É—Ä (—à–æ–ø–æ–≥–æ–ª–∏–∫) üõçÔ∏è',
        dialog: [
          { person: `–ü—Ä–∏–≤–µ—Ç, –ù–∞—Å—Ç—è! –≠—Ç–æ –ê—Ä—Ç—É—Ä. –°–ª—ã—à–∞–ª, —Ç—ã –∫–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—à—å –º–µ–º—ã –ø—Ä–æ –º–µ–ª—Å—Ç—Ä–æ—è?`, options: [
              { text: '–ê—Ä—Ç—É—Ä, –ø—Ä–∏–≤–µ—Ç! –î–∞, –æ–±–æ–∂–∞—é', nextPerson: '–û—Ç–ª–∏—á–Ω–æ! –£ –º–µ–Ω—è –µ—Å—Ç—å —ç–∫—Å–∫–ª—é–∑–∏–≤: –∫–∞–∫ –ú–µ–ª—Å—Ç—Ä–æ–π –ø–æ–∫—É–ø–∞–ª —á–∞–Ω.' },
          ]},
          { person: `–ö—Å—Ç–∞—Ç–∏, —Ç—ã –≤–∏–¥–µ–ª–∞ –Ω–æ–≤—ã–π –º–µ–º "–ù–∞—Å—Ç—è —á–∞–Ω –∏ –¥—Ä—É–Ω—ã"? –¢–∞–º –ê—Ä—Ç—É—Ä –≤ –≥–ª–∞–≤–Ω–æ–π —Ä–æ–ª–∏.`, options: [
              { text: '–ù–µ –≤–∏–¥–µ–ª–∞, –ø–æ–∫–∞–∂–∏!', nextPerson: '–°–µ–π—á–∞—Å —Å–∫–∏–Ω—É: "–ê—Ä—Ç—É—Ä –≥–æ–≤–æ—Ä–∏—Ç: –¥—Ä—É–Ω—ã, —ç—Ç–æ –ù–∞—Å—Ç—è —á–∞–Ω? ‚Äì –ù–µ, —ç—Ç–æ —á–∞–Ω —Å –ù–∞—Å—Ç–µ–π."' },
          ]},
          { person: `–ê –¥–∞–≤–∞–π –∑–∞–¥—Ä—É–Ω–∏–º? –£ –Ω–∞—Å —Ç—É—Ç –¥—Ä—É–Ω-–∫–ª–∞–Ω, –≤—Å–µ —Å–≤–æ–∏.`, options: [
              { text: '–ê –ú–µ–ª—Å—Ç—Ä–æ–π —Ç–∞–º?', nextPerson: '–ö–æ–Ω–µ—á–Ω–æ, –æ–Ω –≥–ª–∞–≤–Ω—ã–π –¥—Ä–∏—â.' },
              { text: '–Ø —Å –≤–∞–º–∏', nextPerson: '–ü—Ä–∏–Ω—è—Ç–æ! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ —Å–µ–º—å—é.' }
          ]},
          { person: `–° –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–º, –ù–∞—Å—Ç—è! –ü—É—Å—Ç—å —É —Ç–µ–±—è –±—É–¥–µ—Ç —Å—Ç–æ–ª—å–∫–æ –∂–µ –¥–µ–Ω–µ–≥, —Å–∫–æ–ª—å–∫–æ —É –ú–µ–ª—Å—Ç—Ä–æ—è –Ω–∞ –∫–∞—Ä—Ç–µ.`, options: [
              { text: '–•–∞—Ö–∞, —Å–ø–∞—Å–∏–±–æ', nextPerson: '–ò –ø–æ–º–Ω–∏: –¥—Ä—É–Ω—ã –Ω–µ —Å–¥–∞—é—Ç—Å—è! –ü—Ä–∏–≤–µ—Ç –æ—Ç –î—Ä—É–Ω–∞.' }
          ]},
          { person: `–õ–∞–¥–Ω–æ, –ø–æ–±–µ–∂–∞–ª —à–æ–ø–∏—Ç—å—Å—è. –î–∞–≤–∞–π, –ù–∞—Å—Ç—è —á–∞–Ω!`, options: [] }
        ]
      },
      { // 3. –ù–∞—Å—Ç—è —á–∞–Ω (–ø–µ—Ä—Å–æ–Ω–∞–∂)
        name: '–ù–∞—Å—Ç—è —á–∞–Ω ü´ñ',
        dialog: [
          { person: `–ü—Ä–∏–≤–µ—Ç, —ç—Ç–æ –ù–∞—Å—Ç—è —á–∞–Ω! –¢–∞ —Å–∞–º–∞—è, —á—Ç–æ —É–ø–∞–ª–∞ —Å —á–∞–Ω–∞.`, options: [
              { text: '–û–π, –ø—Ä–∏–≤–µ—Ç! –õ–µ–≥–µ–Ω–¥–∞!', nextPerson: '–ê–≥–∞, —Ç–µ–ø–µ—Ä—å —è –º–µ–º. –ú–µ–ª—Å—Ç—Ä–æ–π –º–µ–Ω—è —á–∞—Å—Ç–æ –≤—Å–ø–æ–º–∏–Ω–∞–µ—Ç.' },
          ]},
          { person: `–°–ª—ã—à–∞–ª–∞, —Ç—ã —Ç–æ–∂–µ –ù–∞—Å—Ç—è? –ú–æ–∂–µ—Ç, –º—ã —Å—ë—Å—Ç—Ä—ã?`, options: [
              { text: '–ú–æ–∂–µ—Ç –±—ã—Ç—å! –ê —É —Ç–µ–±—è –µ—Å—Ç—å –¥—Ä—É–Ω—ã?', nextPerson: '–ö–æ–Ω–µ—á–Ω–æ! –ê—Ä—Ç—É—Ä, –î—Ä—É–Ω –∏ –¥–∞–∂–µ –ú–µ–ª—Å—Ç—Ä–æ–π.' },
          ]},
          { person: `–î–∞–≤–∞–π –¥—Ä—É–∂–∏—Ç—å? –ë—É–¥–µ–º –≤–º–µ—Å—Ç–µ –ø–∞–¥–∞—Ç—å —Å —á–∞–Ω–∞.`, options: [
              { text: '–î–∞–≤–∞–π! –ê —ç—Ç–æ –±–æ–ª—å–Ω–æ?', nextPerson: '–ì–ª–∞–≤–Ω–æ–µ, —á—Ç–æ–±—ã –¥—Ä—É–Ω—ã –ø–æ–π–º–∞–ª–∏.' },
          ]},
          { person: `–° 14 —Ñ–µ–≤—Ä–∞–ª—è, —Å–µ—Å—Ç—Ä–∞! –ü—É—Å—Ç—å —á–∞–Ω –≤—Å–µ–≥–¥–∞ –±—É–¥–µ—Ç –ø–æ–ª–æ–Ω –º–µ–º–æ–≤.`, options: [
              { text: '–ò —Ç–µ–±—è, –ù–∞—Å—Ç—è —á–∞–Ω! ‚ù§Ô∏è', nextPerson: '–ü–µ—Ä–µ–¥–∞–º –ø—Ä–∏–≤–µ—Ç –ú–µ–ª—Å—Ç—Ä–æ—é –∏ –ê—Ä—Ç—É—Ä—É.' },
          ]},
          { person: `–ü–æ–∫–∞, –ø–æ–ª–µ—á—É –Ω–∞ –º–µ—Ç–ª–µ.`, options: [] }
        ]
      },
      { // 4. –®—É—Ç–Ω–∏–∫ (–º–µ–º–Ω—ã–π)
        name: '–®—É—Ç–Ω–∏–∫ ü§°',
        dialog: [
          { person: `–°–ª—ã—Ö–∞–ª–∞ –∞–Ω–µ–∫–¥–æ—Ç? –ú–µ–ª—Å—Ç—Ä–æ–π –∑–∞—Ö–æ–¥–∏—Ç –≤ —á–∞–Ω, –∞ —Ç–∞–º –ù–∞—Å—Ç—è...`, options: [
              { text: '–ò —á—Ç–æ –¥–∞–ª—å—à–µ?', nextPerson: '–ê –¥–∞–ª—å—à–µ –¥—Ä—É–Ω—ã –ø—Ä–∏–±–µ–∂–∞–ª–∏ –∏ –Ω–∞—á–∞–ª–∏ –¥—Ä—É–Ω–∏—Ç—å!' },
          ]},
          { person: `–ê —Ç—ã –∑–Ω–∞–µ—à—å, –ø–æ—á–µ–º—É –ê—Ä—Ç—É—Ä –≤—Å–µ–≥–¥–∞ –ø—Ä–∏ –¥–µ–Ω—å–≥–∞—Ö? –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω —à–æ–ø–æ–≥–æ–ª–∏–∫!`, options: [
              { text: '–õ–æ–ª', nextPerson: '–ê –µ—â—ë –æ–Ω –¥—Ä—É–∂–∏—Ç —Å –î—Ä—É–Ω–æ–º, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—à—å?' },
          ]},
          { person: `–ö—Å—Ç–∞—Ç–∏, —Ç—ë–∑–∫–∞ —Ç–≤–æ—è ‚Äî –ù–∞—Å—Ç—è —á–∞–Ω ‚Äî —Å–µ–≥–æ–¥–Ω—è —É–ø–∞–ª–∞ —Å —á–∞–Ω–∞. –ü–æ–π–¥—ë–º –ª–æ–≤–∏—Ç—å?`, options: [
              { text: '–ë–µ–∂–∏–º!', nextPerson: '–î—Ä—É–Ω—ã —É–∂–µ –≤ –ø—É—Ç–∏!' },
          ]},
          { person: `–° 14 —Ñ–µ–≤—Ä–∞–ª—è! –ñ–µ–ª–∞—é, —á—Ç–æ–±—ã —Ç–≤–æ–π —á–∞–Ω –≤—Å–µ–≥–¥–∞ –±—ã–ª –ø–æ–ª–æ–Ω —Å–º–µ—Ö–∞.`, options: [
              { text: '–°–ø–∞—Å–∏–±–æ, —à—É—Ç–Ω–∏–∫!', nextPerson: '–ü–µ—Ä–µ–¥–∞–≤–∞–π –ø—Ä–∏–≤–µ—Ç –ê—Ä—Ç—É—Ä—É.' },
          ]},
          { person: `–í—Å—ë, —è —É–º–æ—Ç–∞–ª.`, options: [] }
        ]
      },
      { // 5. –†–æ–º–∞–Ω—Ç–∏–∫ (—Å –º–µ–º–Ω—ã–º –æ—Ç—Ç–µ–Ω–∫–æ–º)
        name: '–†–æ–º–∞–Ω—Ç–∏–∫ üíò',
        dialog: [
          { person: `–ù–∞—Å—Ç—è, —Ç—ã –∫–∞–∫ –º–µ–ª—Å—Ç—Ä–æ–π –≤ –º–æ—ë–º —Å–µ—Ä–¥—Ü–µ ‚Äî –≤—Å–µ–≥–¥–∞ –≤ —Ç—Ä–µ–Ω–¥–µ.`, options: [
              { text: '–û–π, —Å–ø–∞—Å–∏–±–æ', nextPerson: '–¢—ã –ø—Ä–µ–∫—Ä–∞—Å–Ω–∞, –∫–∞–∫ –¥—Ä—É–Ω –Ω–∞ –∑–∞–∫–∞—Ç–µ.' },
          ]},
          { person: `–Ø —Ö–æ—á—É –ø–æ–¥–∞—Ä–∏—Ç—å —Ç–µ–±–µ —á–∞–Ω, –ø–æ–ª–Ω—ã–π –ª—é–±–≤–∏.`, options: [
              { text: '–ê —Ç–∞–º –±—É–¥—É—Ç –º–µ–º—ã?', nextPerson: '–ö–æ–Ω–µ—á–Ω–æ, —Å –ê—Ä—Ç—É—Ä–æ–º –∏ –ú–µ–ª—Å—Ç—Ä–æ–µ–º.' },
          ]},
          { person: `–¢—ã —Å–æ–≥–ª–∞—Å–Ω–∞ —Å—Ç–∞—Ç—å –º–æ–µ–π –ù–∞—Å—Ç–µ–π —á–∞–Ω?`, options: [
              { text: '–î–∞', nextPerson: '–£—Ä–∞! –¢–µ–ø–µ—Ä—å –º—ã –±—É–¥–µ–º –¥—Ä—É–Ω–∏—Ç—å –≤–º–µ—Å—Ç–µ.' },
          ]},
          { person: `–° 14 —Ñ–µ–≤—Ä–∞–ª—è, –ª—é–±–∏–º–∞—è! –ü—É—Å—Ç—å –¥—Ä—É–Ω—ã –Ω–∞—Å –±–ª–∞–≥–æ—Å–ª–æ–≤—è—Ç.`, options: [
              { text: '‚ù§Ô∏è', nextPerson: '–ü—Ä–∏–≤–µ—Ç –ê—Ä—Ç—É—Ä—É –∏ –ú–µ–ª—Å—Ç—Ä–æ—é!' },
          ]},
          { person: `–¶–µ–ª—É—é, –º–æ—è —á–∞–Ω.`, options: [] }
        ]
      },
      { // 6. –§–∏–ª–æ—Å–æ—Ñ
        name: '–§–∏–ª–æ—Å–æ—Ñ üìø',
        dialog: [
          { person: `–ù–∞—Å—Ç—è, –∑–∞–¥—É–º–∞–π—Å—è: –µ—Å–ª–∏ –º–µ–ª—Å—Ç—Ä–æ–π —É–ø–∞–ª —Å —á–∞–Ω–∞, –∞ —Ä—è–¥–æ–º –±—ã–ª –¥—Ä—É–Ω, —Å–ª—ã—à–µ–Ω –ª–∏ –∑–≤—É–∫?`, options: [
              { text: '–≠—Ç–æ –≥–ª—É–±–æ–∫–∏–π –≤–æ–ø—Ä–æ—Å', nextPerson: '–§–∏–ª–æ—Å–æ—Ñ–∏—è –¥—Ä—É–Ω–æ–≤ ‚Äî –≤–æ—Ç –æ—Ç–≤–µ—Ç.' },
          ]},
          { person: `–ê—Ä—Ç—É—Ä —Å–∫–∞–∑–∞–ª, —á—Ç–æ —Å—á–∞—Å—Ç—å–µ –Ω–µ –≤ —à–æ–ø–∏–Ω–≥–µ, –∞ –≤ –º–æ–º–µ–Ω—Ç–µ, –∫–æ–≥–¥–∞ —Ç—ã –ø—å—ë—à—å —á–∞–π —Å —á–∞–Ω–∞.`, options: [
              { text: '–ú—É–¥—Ä–æ', nextPerson: '–≠—Ç–æ –≤—Å—ë –æ–ø—ã—Ç –ù–∞—Å—Ç–∏ —á–∞–Ω.' },
          ]},
          { person: `–ë—ã—Ç—å –∏–ª–∏ –Ω–µ –±—ã—Ç—å –¥—Ä—É–Ω–æ–º? –í–æ—Ç –≤ —á—ë–º –≤–æ–ø—Ä–æ—Å.`, options: [
              { text: '–ë—ã—Ç—å!', nextPerson: '–¢–æ–≥–¥–∞ —Ç—ã –Ω–∞—à–∞.' },
          ]},
          { person: `–° 14 —Ñ–µ–≤—Ä–∞–ª—è. –ü—É—Å—Ç—å —Ç–≤–æ–π –ø—É—Ç—å –±—É–¥–µ—Ç –æ—Å–≤–µ—â—ë–Ω –º–µ–º–∞–º–∏.`, options: [
              { text: '–°–ø–∞—Å–∏–±–æ, —Ñ–∏–ª–æ—Å–æ—Ñ', nextPerson: '–ò –ø–æ–º–Ω–∏: –¥—Ä—É–Ω—ã –≤–µ—á–Ω—ã.' },
          ]},
          { person: `–ü–æ–π–¥—É –º–µ–¥–∏—Ç–∏—Ä–æ–≤–∞—Ç—å —Å –ú–µ–ª—Å—Ç—Ä–æ–µ–º.`, options: [] }
        ]
      },
      { // 7. –¢–∞–π–Ω—ã–π –ø–æ–∫–ª–æ–Ω–Ω–∏–∫ (–ù–∞—Å—Ç—è —á–∞–Ω —Ç–µ–º–∞—Ç–∏–∫–∞)
        name: '–¢–∞–π–Ω—ã–π ü§´',
        dialog: [
          { person: `–¢—ã –¥–∞–∂–µ –Ω–µ –∑–Ω–∞–µ—à—å, –∫–∞–∫ —è –∂–¥–∞–ª —ç—Ç–æ–≥–æ 14 —Ñ–µ–≤—Ä–∞–ª—è.`, options: [
              { text: '–ö—Ç–æ —Ç—ã?', nextPerson: '–Ø —Ç–æ—Ç, –∫—Ç–æ –≤–∏–¥–∏—Ç –≤ —Ç–µ–±–µ –ù–∞—Å—Ç—é —á–∞–Ω.' },
          ]},
          { person: `–¢—ã –∫—Ä–∞—Å–∏–≤–µ–µ, —á–µ–º –ú–µ–ª—Å—Ç—Ä–æ–π –≤ –Ω–æ–≤–æ–º –º–µ—Ä—á–µ.`, options: [
              { text: '–•–∞—Ö–∞, —Å–ø–∞—Å–∏–±–æ', nextPerson: '–ò –¥–æ–±—Ä–µ–µ, —á–µ–º –¥—Ä—É–Ω —Å –ø–æ—Ö–º–µ–ª—å—è.' },
          ]},
          { person: `–Ø —Ö–æ—á—É –ø—Ä–∏–∑–Ω–∞—Ç—å—Å—è: —è ‚Äî –ê—Ä—Ç—É—Ä. –®—É—á—É, —è –ø—Ä–æ—Å—Ç–æ —Ç–∞–π–Ω—ã–π –ø–æ–∫–ª–æ–Ω–Ω–∏–∫.`, options: [
              { text: '–ó–∞–∏–Ω—Ç—Ä–∏–≥–æ–≤–∞–ª', nextPerson: '–ï—â—ë —è –∑–Ω–∞—é, —á—Ç–æ —Ç—ã –ª—é–±–∏—à—å –º–µ–º—ã –ø—Ä–æ —á–∞–Ω.' },
          ]},
          { person: `–° 14 —Ñ–µ–≤—Ä–∞–ª—è, –ù–∞—Å—Ç—è! –ë—É–¥—å —Å—á–∞—Å—Ç–ª–∏–≤–∞ —Å –∫–µ–º –±—ã —Ç—ã –Ω–∏ –±—ã–ª–∞.`, options: [
              { text: '–°–ø–∞—Å–∏–±–æ, —Ç–∞–π–Ω—ã–π', nextPerson: '–ü–µ—Ä–µ–¥–∞–π –ø—Ä–∏–≤–µ—Ç –î—Ä—É–Ω—É –æ—Ç –º–µ–Ω—è.' },
          ]},
          { person: `–Ø –∏—Å—á–µ–∑–∞—é...`, options: [] }
        ]
      }
    ];

    // ---------- DOM ----------
    const chatListEl = document.getElementById('chatList');
    const chatWindow = document.getElementById('chatWindow');
    const chatTitle = document.getElementById('chatTitle');
    const chatAvatar = document.getElementById('chatAvatar');
    const messagesDiv = document.getElementById('messages');
    const statusEl = document.getElementById('status');
    const optionsArea = document.getElementById('optionsArea');
    const manualInputArea = document.getElementById('manualInputArea');
    const userInput = document.getElementById('userInput');

    let currentChat = null;
    let currentDialog = null;
    let stepIndex = 0;
    let timeoutId = null;
    let waitingForUser = false;

    // –º—É–∑—ã–∫–∞
    const music = document.getElementById('bgMusic');
    music.volume = 0.2;
    music.play().catch(() => {});

    // –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —á–∞—Ç–æ–≤
    chats.forEach((chat, i) => {
      const div = document.createElement('div');
      div.className = 'chat-item';
      div.innerHTML = `
        <div class="avatar" style="background-image:url('${avatars[i % avatars.length]}')"></div>
        <div class="chat-info">
          <div class="chat-name">${chat.name}</div>
          <div class="chat-last">${chat.dialog[0]?.person || '...'}</div>
        </div>
        <div class="chat-time">‚ù§Ô∏è</div>
      `;
      div.onclick = () => openChat(i);
      chatListEl.appendChild(div);
    });

    function openChat(index) {
      if (timeoutId) clearTimeout(timeoutId);
      currentChat = chats[index];
      currentDialog = currentChat.dialog.slice();
      stepIndex = 0;

      chatTitle.innerText = currentChat.name;
      chatAvatar.style.backgroundImage = `url('${avatars[index % avatars.length]}')`;
      messagesDiv.innerHTML = '';
      chatWindow.classList.add('active');
      statusEl.innerText = '–≤ —Å–µ—Ç–∏';

      manualInputArea.style.display = 'flex';
      optionsArea.style.display = 'none';
      optionsArea.innerHTML = '';

      showCurrentPersonMessage();
    }

    window.closeChat = function() {
      chatWindow.classList.remove('active');
      if (timeoutId) clearTimeout(timeoutId);
    };

    function showCurrentPersonMessage() {
      if (!currentDialog || stepIndex >= currentDialog.length) {
        statusEl.innerText = '–æ–Ω–ª–∞–π–Ω';
        optionsArea.style.display = 'none';
        return;
      }

      const step = currentDialog[stepIndex];
      statusEl.innerText = '–ø–µ—á–∞—Ç–∞–µ—Ç...';

      timeoutId = setTimeout(() => {
        statusEl.innerText = '–≤ —Å–µ—Ç–∏';
        addMessage(step.person, 'received');
        if (step.options && step.options.length > 0) {
          showOptions(step.options);
        } else {
          optionsArea.style.display = 'none';
        }
      }, 1000);
    }

    function showOptions(options) {
      optionsArea.innerHTML = '';
      options.forEach(opt => {
        const btn = document.createElement('button');
        btn.className = 'option-btn';
        btn.innerText = opt.text;
        btn.onclick = () => onOptionSelected(opt);
        optionsArea.appendChild(btn);
      });
      optionsArea.style.display = 'flex';
      waitingForUser = true;
    }

    function onOptionSelected(opt) {
      if (!waitingForUser) return;
      waitingForUser = false;
      optionsArea.style.display = 'none';

      statusEl.innerText = '–ø–µ—á–∞—Ç–∞–µ—Ç...';
      setTimeout(() => {
        addMessage(opt.text, 'sent');
        statusEl.innerText = '–≤ —Å–µ—Ç–∏';

        if (opt.nextPerson) {
          timeoutId = setTimeout(() => {
            addMessage(opt.nextPerson, 'received');
            stepIndex++;
            if (stepIndex < currentDialog.length) {
              timeoutId = setTimeout(() => {
                const nextStep = currentDialog[stepIndex];
                addMessage(nextStep.person, 'received');
                if (nextStep.options && nextStep.options.length > 0) {
                  showOptions(nextStep.options);
                } else {
                  optionsArea.style.display = 'none';
                }
              }, 1200);
            } else {
              optionsArea.style.display = 'none';
            }
          }, 1000);
        } else {
          stepIndex++;
          if (stepIndex < currentDialog.length) {
            timeoutId = setTimeout(() => {
              showCurrentPersonMessage();
            }, 1200);
          }
        }
      }, 800);
    }

    function addMessage(text, type) {
      const msgDiv = document.createElement('div');
      msgDiv.className = `message ${type}`;
      const time = new Date().toLocaleTimeString('ru-Ru', { hour: '2-digit', minute: '2-digit' });
      msgDiv.innerHTML = `${text} <span class="time">${time}</span>`;
      messagesDiv.appendChild(msgDiv);
      messagesDiv.scrollTop = messagesDiv.scrollHeight;
    }

    window.sendManualMessage = function() {
      const text = userInput.value.trim();
      if (!text) return;
      addMessage(text, 'sent');
      userInput.value = '';
      if (currentDialog && stepIndex < currentDialog.length) {
        statusEl.innerText = '–ø–µ—á–∞—Ç–∞–µ—Ç...';
        setTimeout(() => {
          statusEl.innerText = '–≤ —Å–µ—Ç–∏';
          addMessage('üòÑ –º–µ–º–Ω—ã–π –ø—Ä–∏–≤–µ—Ç –æ—Ç –ê—Ä—Ç—É—Ä–∞!', 'received');
        }, 1500);
      }
    };

    function createHeart() {
      const heart = document.createElement('div');
      heart.className = 'heart';
      heart.innerText = '‚ù§Ô∏è';
      heart.style.left = Math.random() * 100 + '%';
      heart.style.bottom = '0';
      heart.style.fontSize = (15 + Math.random() * 30) + 'px';
      heart.style.animationDuration = (3 + Math.random() * 4) + 's';
      document.body.appendChild(heart);
      setTimeout(() => heart.remove(), 5000);
    }

    window.addEventListener('load', () => {
      for (let i = 0; i < 12; i++) setTimeout(createHeart, i * 200);
    });

    document.addEventListener('touchstart', (e) => {
      if (e.target.closest('.avatar')) {
        for (let i = 0; i < 10; i++) setTimeout(createHeart, i * 40);
      }
    });
  })();
</script>



</body>
</html>
